---
import MinimalLayout from "../../layouts/MinimalLayout.astro";
import { getCollection } from 'astro:content';
import { CollectionEntry } from 'astro:content';

const allPosts = await getCollection('blog');
const slug = Astro.params.slug instanceof Array ? Astro.params.slug.join('/') : Astro.params.slug;
const entry = allPosts.find((p) => p.slug === slug) as CollectionEntry<'blog'> | undefined;
if (!entry) {
  return Astro.redirect('/');
}
const { Content, data } = await entry.render();
---
<MinimalLayout title={data.title}>
  <article>
    <h1>{data.title}</h1>
    <div class="meta">{new Date(data.date).toDateString()}</div>
    <Content />
  </article>
</MinimalLayout>
